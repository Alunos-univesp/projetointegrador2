<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-image: url('https://wallpapercave.com/wp/wp4998130.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: white;
        }

        .brand {
            font-size: 38px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .form-signin {
            width: 100%;
            max-width: 400px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.7);
            box-shadow: 0 4px 6px rgba(0, 0, 0, .1);
            border-radius: 5px;
        }

        .form-signin .form-control {
            position: relative;
            height: auto;
            padding: 10px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.8);
        }

        .form-signin input[type="email"], .form-signin input[type="password"] {
            margin-bottom: 10px;
        }
    </style>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-auth.js"></script>
    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyCCTTKM8tFMwxcYULKZwrBNO8W8hkbW_PM",
            authDomain: "controle-de-mercadoria.firebaseapp.com",
            projectId: "controle-de-mercadoria",
            storageBucket: "controle-de-mercadoria.appspot.com",
            messagingSenderId: "582797948259",
            appId: "1:582797948259:web:controle-de-mercadoria"
        };
        firebase.initializeApp(firebaseConfig);
    </script>
</head>
<body>
    <div class="brand">Controle de Mercadoria</div>
    <div class="form-signin">
        <h2 class="text-center">Login</h2>
        <input type="email" id="inputEmail" class="form-control" placeholder="Endereço de Email" required autofocus>
        <input type="password" id="inputPassword" class="form-control" placeholder="Senha" required>
        <button class="btn btn-lg btn-primary btn-block" onclick="login()" id="loginButton">Entrar</button>
        <div class="text-center mt-3">
            <a href="#" onclick="resetPassword()">Esqueceu a senha?</a>
        </div>
    </div>
    <script>
        function login() {
            var email = document.getElementById('inputEmail').value;
            var password = document.getElementById('inputPassword').value;
            var loginButton = document.getElementById('loginButton');

            // Valida se os campos estão preenchidos
            if (!email || !password) {
                alert("Por favor, preencha todos os campos.");
                return;
            }

            // Mostra feedback de carregamento no botão
            loginButton.textContent = 'Carregando...';
            loginButton.disabled = true;

            firebase.auth().signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    window.location.href = '/home';
                })
                .catch((error) => {
                    let errorMessage = error.message;
                    if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                        errorMessage = "E-mail ou senha incorretos.";
                    }
                    alert("Erro ao autenticar: " + errorMessage);
                })
                .finally(() => {
                    loginButton.textContent = 'Entrar';
                    loginButton.disabled = false;
                });
        }

        function resetPassword() {
            var email = document.getElementById('inputEmail').value;
            if (email) {
                firebase.auth().sendPasswordResetEmail(email)
                    .then(() => {
                        alert('Email de redefinição de senha enviado.');
                    })
                    .catch((error) => {
                        alert('Erro ao enviar email de redefinição de senha: ' + error.message);
                    });
            } else {
                alert('Por favor, insira seu email no campo de email.');
            }
        }
    </script>
</body>
</html>
